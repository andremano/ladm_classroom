-- QGIS Virtual layer --select 'BAU'||'-'||cast(row_number() over() as string) as id, 	   r.party_id,	   r.type as right_type,		   datetime() as starting_Date,	   st_union(s.geometry) as geometryfrom rrr as r join spatial_unit as s on r.spatial_unit = s.sunit_idgroup by r.party_id-- Geopackage view returning 15 BAU - --/*Create view bau as select 'BAU'||'-'||cast(row_number() over() as string) as id, 	   r.party_id,	   r.type as right_type,		   datetime() as starting_Date,	   st_union(s.geom) as geomfrom rrr as r join spatial_unit as s on r.spatial_unit = s.sunit_idgroup by r.party_id*/--Yelding 13 BAU as supposed (QGIS query)with plots as(select --'BAU'||'-'||cast(row_number() over() as string) as id, 	   substring(r.spatial_unit,0,5) as spatial_unit,	   r.type,	   r.party_id,	   datetime() as starting_Datefrom rrr as r left join spatial_unit as s on r.spatial_unit = s.sunit_idwhere r.party_id is not null),buildings as (select --'BAU'||'-'||cast(row_number() over() as string) as id, 	   substring(r.spatial_unit,0,5) as spatial_unit,	   r.type,	   r.party_id,	   datetime() as starting_Datefrom rrr as r left join spatial_unit as s on r.spatial_unit = s.sunit_idwhere r.party_id is not null and s.sunit_id like '%-%')--merged asselect 'BAU'||'-'||cast(row_number() over() as string) as id, p.type)  from plots as p join buildings as b on p.spatial_unit = b.spatial_unitgroup by  p.party_id